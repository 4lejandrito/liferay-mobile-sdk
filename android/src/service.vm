package $package;

import com.liferay.client.http.HttpUtil;
import com.liferay.client.service.BaseService;
import com.liferay.client.service.JSONWrapper;
import com.liferay.client.service.ServiceContext;
import com.liferay.client.task.ServiceAsyncTask;
import com.liferay.client.task.TaskCallback;

import org.json.JSONArray;
import org.json.JSONException;
import org.json.JSONObject;

#set ($className = $javaUtil.getServiceClassName($serviceContext))
#set ($actions = $discovery.actions)

public class $className extends BaseService {

	public $className(ServiceContext context) {
		super(context);
	}

	public $className(ServiceContext context, TaskCallback callback) {
		super(context, callback);
	}

	#foreach ($action in $actions)
		#set ($returnType = $javaUtil.getReturnType($action.response))
		#set ($methodName = $javaUtil.getMethodName($action.path))
		#set ($parameters = $action.parameters)

		#set ($parameterList = "")
		#set ($jsonObj = "JSONObject params = new JSONObject();${esc.n}")

		#foreach ($parameter in $parameters)
			#set ($parameterName = $parameter.name)
			#set ($parameterType = $javaUtil.getType($parameter.type))
			#set ($parameterList = "$parameterList$parameterType $parameterName")

			#set ($jsonObj = "$jsonObj${esc.n}params.put(${esc.q}$parameterName${esc.q}, $parameterName);")

			#if ($foreach.hasNext)
				#set ($parameterList = "$parameterList, ")
			#end
		#end

		public $returnType $methodName($parameterList) throws Exception {
			JSONObject command = new JSONObject();

			try {
				$jsonObj

				command.put(${esc.q}$action.path${esc.q}, params);
			}
			catch (JSONException je) {
				throw new Exception(je);
			}

			TaskCallback callback = getCallback();

			if (callback != null) {
				ServiceAsyncTask task = new ServiceAsyncTask(getContext(), callback);

				task.execute(command);

				#if ($returnType == "void")
					return;
				#else
					return null;
				#end
			}
			else {
				#if ($returnType == "void")
					HttpUtil.post(getContext(), command);
				#else
					JSONWrapper json = HttpUtil.post(getContext(), command);

					#if ($returnType == "JSONArray")
						return json.getJSONArray();
					#else
						return json.getJSONObject();
					#end
				#end
			}
		}
	#end

}